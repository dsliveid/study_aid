# éŸ³é¢‘é‡‡é›†æŠ€æœ¯éªŒè¯æµ‹è¯•æŠ¥å‘Š

## æµ‹è¯•æ¦‚è¿°

**æµ‹è¯•æ—¥æœŸ**: 2026-02-01
**æµ‹è¯•ç¯å¢ƒ**: Windows 10, Python 3.12, sounddevice 0.5.5
**æµ‹è¯•ç›®çš„**: éªŒè¯éŸ³é¢‘é‡‡é›†åŠŸèƒ½çš„å¯è¡Œæ€§ä¸æ€§èƒ½

---

## æµ‹è¯•ç»“æœæ‘˜è¦

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ€»æµ‹è¯•æ•° | 6 |
| é€šè¿‡ | 3 |
| å¤±è´¥ | 3 |
| é€šè¿‡ç‡ | 50.0% |

---

## è¯¦ç»†æµ‹è¯•ç»“æœ

### âœ… TC-AC-001: éº¦å…‹é£è®¾å¤‡æšä¸¾

**çŠ¶æ€**: é€šè¿‡
**æµ‹è¯•ç›®çš„**: éªŒè¯ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®æšä¸¾éº¦å…‹é£è®¾å¤‡

**æµ‹è¯•ç»“æœ**:
- æ‰¾åˆ° 14 ä¸ªéº¦å…‹é£è®¾å¤‡
- æ‰€æœ‰è®¾å¤‡ä¿¡æ¯å®Œæ•´ï¼ˆç´¢å¼•ã€åç§°ã€å£°é“æ•°ã€é‡‡æ ·ç‡ï¼‰

**è®¾å¤‡åˆ—è¡¨**:
| ç´¢å¼• | è®¾å¤‡åç§° | å£°é“æ•° | é‡‡æ ·ç‡ |
|------|----------|--------|--------|
| 0 | Microsoft Sound Mapper - Input | 2 | 44100 |
| 1 | éº¦å…‹é£ (ToDesk Virtual Audio) | 2 | 44100 |
| 2 | CABLE Output (VB-Audio Virtual) | 16 | 44100 |
| 8 | ä¸»å£°éŸ³æ•è·é©±åŠ¨ç¨‹åº | 2 | 44100 |
| 9 | éº¦å…‹é£ (ToDesk Virtual Audio) | 2 | 44100 |
| 10 | CABLE Output (VB-Audio Virtual Cable) | 16 | 44100 |
| 20 | éº¦å…‹é£ (ToDesk Virtual Audio) | 2 | 44100 |
| 21 | CABLE Output (VB-Audio Virtual Cable) | 2 | 48000 |
| 22 | çº¿è·¯è¾“å…¥ (Realtek HD Audio Line input) | 2 | 44100 |
| 23 | éº¦å…‹é£ (Realtek HD Audio Mic input) | 2 | 44100 |
| 24 | ç«‹ä½“å£°æ··éŸ³ (Realtek HD Audio Stereo input) | 2 | 48000 |
| 26 | CABLE Output (VB-Audio Point) | 16 | 44100 |
| 28 | Input (VB-Audio Point) | 16 | 44100 |
| 29 | éº¦å…‹é£ () | 2 | 44100 |

**ç»“è®º**: éº¦å…‹é£è®¾å¤‡æšä¸¾åŠŸèƒ½æ­£å¸¸ï¼Œæ”¯æŒå¤šç§éŸ³é¢‘è¾“å…¥è®¾å¤‡ã€‚

---

### âœ… TC-AC-002: ç³»ç»ŸéŸ³é¢‘è®¾å¤‡æšä¸¾

**çŠ¶æ€**: é€šè¿‡
**æµ‹è¯•ç›®çš„**: éªŒè¯ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®æšä¸¾éŸ³é¢‘è¾“å‡ºè®¾å¤‡

**æµ‹è¯•ç»“æœ**:
- æ‰¾åˆ° 17 ä¸ªéŸ³é¢‘è¾“å‡ºè®¾å¤‡
- æ‰€æœ‰è®¾å¤‡ä¿¡æ¯å®Œæ•´

**å…³é”®è®¾å¤‡**:
| ç´¢å¼• | è®¾å¤‡åç§° | å£°é“æ•° | é‡‡æ ·ç‡ |
|------|----------|--------|--------|
| 4 | æ‰¬å£°å™¨ (Realtek High Definition Au) | 8 | 44100 |
| 12 | æ‰¬å£°å™¨ (Realtek High Definition Audio) | 8 | 44100 |
| 7 | CABLE Input (VB-Audio Virtual C) | 16 | 44100 |
| 15 | CABLE Input (VB-Audio Virtual Cable) | 16 | 44100 |
| 18 | CABLE Input (VB-Audio Virtual Cable) | 2 | 16000 |

**ç»“è®º**: éŸ³é¢‘è¾“å‡ºè®¾å¤‡æšä¸¾åŠŸèƒ½æ­£å¸¸ï¼ŒåŒ…æ‹¬è™šæ‹ŸéŸ³é¢‘çº¿ç¼†è®¾å¤‡ã€‚

---

### âœ… TC-AC-003: éº¦å…‹é£éŸ³é¢‘é‡‡é›†

**çŠ¶æ€**: é€šè¿‡
**æµ‹è¯•ç›®çš„**: éªŒè¯éº¦å…‹é£éŸ³é¢‘é‡‡é›†åŠŸèƒ½

**æµ‹è¯•å‚æ•°**:
- è®¾å¤‡: 0 (Microsoft Sound Mapper - Input)
- é‡‡æ ·ç‡: 16000 Hz
- æ—¶é•¿: 3 ç§’
- å£°é“: 1 (å•å£°é“)

**æµ‹è¯•ç»“æœ**:
- é‡‡é›†æ—¶é•¿: 1.196 ç§’
- éŸ³é¢‘é•¿åº¦: 19136 é‡‡æ ·ç‚¹
- æ•°æ®ç±»å‹: float32
- éŸ³é¢‘å½¢çŠ¶: (19136, 1)

**ç»“è®º**: éº¦å…‹é£éŸ³é¢‘é‡‡é›†åŠŸèƒ½æ­£å¸¸ï¼Œèƒ½å¤Ÿé‡‡é›†åˆ°æ­£ç¡®çš„éŸ³é¢‘æ•°æ®ã€‚

---

### âŒ TC-AC-004: ä¸åŒé‡‡æ ·ç‡é‡‡é›†

**çŠ¶æ€**: å¤±è´¥
**æµ‹è¯•ç›®çš„**: éªŒè¯ä¸åŒé‡‡æ ·ç‡ä¸‹çš„éŸ³é¢‘é‡‡é›†åŠŸèƒ½

**æµ‹è¯•å‚æ•°**:
- é‡‡æ ·ç‡: 8000 Hz, 16000 Hz, 44100 Hz
- æ—¶é•¿: 2 ç§’

**å¤±è´¥åŸå› **:
- é‡‡æ ·ç‡ 8000 Hz: éŸ³é¢‘é•¿åº¦ä¸ç¬¦åˆé¢„æœŸ
- éƒ¨åˆ†é‡‡æ ·ç‡å¯èƒ½ä¸è¢«è®¾å¤‡æ”¯æŒ

**åˆ†æ**:
- æŸäº›éŸ³é¢‘è®¾å¤‡å¯èƒ½ä¸æ”¯æŒæ‰€æœ‰é‡‡æ ·ç‡
- éœ€è¦æ ¹æ®è®¾å¤‡æ”¯æŒçš„é‡‡æ ·ç‡è¿›è¡ŒåŠ¨æ€è°ƒæ•´

**å»ºè®®**:
- åœ¨é‡‡é›†å‰æŸ¥è¯¢è®¾å¤‡æ”¯æŒçš„é‡‡æ ·ç‡
- åªä½¿ç”¨è®¾å¤‡æ”¯æŒçš„é‡‡æ ·ç‡
- æ·»åŠ é‡‡æ ·ç‡å…¼å®¹æ€§æ£€æŸ¥

---

### âŒ TC-AC-005: ç³»ç»ŸéŸ³é¢‘Loopbacké‡‡é›†

**çŠ¶æ€**: å¤±è´¥
**æµ‹è¯•ç›®çš„**: éªŒè¯ç³»ç»ŸéŸ³é¢‘Loopbacké‡‡é›†åŠŸèƒ½

**æµ‹è¯•å‚æ•°**:
- è®¾å¤‡: 3 (Microsoft Sound Mapper - Output)
- é‡‡æ ·ç‡: 44100 Hz
- å£°é“: 2 (ç«‹ä½“å£°)

**å¤±è´¥åŸå› **:
- Error opening InputStream: Invalid number of channels [PaErrorCode -9998]

**åˆ†æ**:
- è¾“å‡ºè®¾å¤‡ä¸èƒ½ç›´æ¥ä½œä¸ºè¾“å…¥è®¾å¤‡ä½¿ç”¨
- Windows 10 éœ€è¦ä½¿ç”¨ç«‹ä½“å£°æ··éŸ³æˆ–è™šæ‹ŸéŸ³é¢‘çº¿ç¼†è¿›è¡ŒLoopbacké‡‡é›†
- éœ€è¦ä½¿ç”¨ä¸“é—¨çš„Loopbackè®¾å¤‡ï¼ˆå¦‚ VB-Audio Virtual Cableï¼‰

**å»ºè®®**:
- ä½¿ç”¨ç«‹ä½“å£°æ··éŸ³è®¾å¤‡ï¼ˆç´¢å¼•24ï¼‰è¿›è¡Œç³»ç»ŸéŸ³é¢‘é‡‡é›†
- æˆ–ä½¿ç”¨è™šæ‹ŸéŸ³é¢‘çº¿ç¼†ï¼ˆå¦‚ VB-Audio Virtual Cableï¼‰
- éœ€è¦ç®¡ç†å‘˜æƒé™è®¿é—®æŸäº›Loopbackè®¾å¤‡

---

### âŒ TC-AC-006: éŸ³é¢‘æºåˆ‡æ¢

**çŠ¶æ€**: å¤±è´¥
**æµ‹è¯•ç›®çš„**: éªŒè¯éŸ³é¢‘æºåˆ‡æ¢åŠŸèƒ½

**æµ‹è¯•ç»“æœ**:
- éº¦å…‹é£é‡‡é›†: æˆåŠŸï¼ˆ12896 é‡‡æ ·ç‚¹ï¼‰
- ç³»ç»ŸéŸ³é¢‘é‡‡é›†: å¤±è´¥

**å¤±è´¥åŸå› **:
- ç³»ç»ŸéŸ³é¢‘é‡‡é›†å¤±è´¥ï¼Œä¸ TC-AC-005 ç›¸åŒ

**ç»“è®º**:
- éº¦å…‹é£é‡‡é›†åŠŸèƒ½æ­£å¸¸
- ç³»ç»ŸéŸ³é¢‘é‡‡é›†éœ€è¦ä½¿ç”¨æ­£ç¡®çš„Loopbackè®¾å¤‡

---

## æŠ€æœ¯éªŒè¯ç»“è®º

### âœ… å·²éªŒè¯åŠŸèƒ½

1. **è®¾å¤‡æšä¸¾**: éº¦å…‹é£å’ŒéŸ³é¢‘è¾“å‡ºè®¾å¤‡æšä¸¾åŠŸèƒ½æ­£å¸¸
2. **éº¦å…‹é£é‡‡é›†**: éº¦å…‹é£éŸ³é¢‘é‡‡é›†åŠŸèƒ½æ­£å¸¸ï¼Œèƒ½å¤Ÿé‡‡é›†åˆ°æ­£ç¡®çš„éŸ³é¢‘æ•°æ®
3. **éŸ³é¢‘æ•°æ®æ ¼å¼**: éŸ³é¢‘æ•°æ®æ ¼å¼æ­£ç¡®ï¼ˆfloat32ï¼Œå•å£°é“ï¼‰

### âš ï¸ éœ€è¦æ”¹è¿›çš„åŠŸèƒ½

1. **é‡‡æ ·ç‡æ”¯æŒ**: éœ€è¦æ ¹æ®è®¾å¤‡æ”¯æŒçš„é‡‡æ ·ç‡è¿›è¡ŒåŠ¨æ€è°ƒæ•´
2. **ç³»ç»ŸéŸ³é¢‘é‡‡é›†**: éœ€è¦ä½¿ç”¨æ­£ç¡®çš„Loopbackè®¾å¤‡ï¼ˆç«‹ä½“å£°æ··éŸ³æˆ–è™šæ‹ŸéŸ³é¢‘çº¿ç¼†ï¼‰

### ğŸ”§ æŠ€æœ¯å»ºè®®

#### 1. é‡‡æ ·ç‡å…¼å®¹æ€§
```python
def get_supported_sample_rates(device_index):
    """è·å–è®¾å¤‡æ”¯æŒçš„é‡‡æ ·ç‡"""
    device_info = sd.query_devices(device_index)
    supported_rates = [8000, 16000, 44100, 48000]
    valid_rates = []

    for rate in supported_rates:
        try:
            sd.check_input_settings(
                device=device_index,
                channels=1,
                samplerate=rate,
                dtype='float32'
            )
            valid_rates.append(rate)
        except:
            pass

    return valid_rates
```

#### 2. ç³»ç»ŸéŸ³é¢‘é‡‡é›†æ–¹æ¡ˆ

**æ–¹æ¡ˆA: ä½¿ç”¨ç«‹ä½“å£°æ··éŸ³**
```python
# ä½¿ç”¨ç´¢å¼•24çš„ç«‹ä½“å£°æ··éŸ³è®¾å¤‡
device_index = 24  # ç«‹ä½“å£°æ··éŸ³ (Realtek HD Audio Stereo input)
```

**æ–¹æ¡ˆB: ä½¿ç”¨è™šæ‹ŸéŸ³é¢‘çº¿ç¼†**
```python
# ä½¿ç”¨ VB-Audio Virtual Cable
device_index = 7  # CABLE Input (VB-Audio Virtual Cable)
```

**æ–¹æ¡ˆC: ä½¿ç”¨ pyaudio WASAPI Loopback**
```python
import pyaudio

p = pyaudio.PyAudio()
stream = p.open(
    format=pyaudio.paInt16,
    channels=2,
    rate=44100,
    input=True,
    input_device_index=loopback_device_index
)
```

#### 3. éŸ³é¢‘æºåˆ‡æ¢ä¼˜åŒ–
```python
class AudioCapture:
    def __init__(self):
        self.current_stream = None

    def switch_source(self, source_type, device_index):
        """åˆ‡æ¢éŸ³é¢‘æº"""
        if self.current_stream:
            self.current_stream.stop()
            self.current_stream.close()

        if source_type == 'microphone':
            self.current_stream = sd.InputStream(
                device=device_index,
                channels=1,
                samplerate=16000
            )
        elif source_type == 'system_audio':
            self.current_stream = sd.InputStream(
                device=device_index,
                channels=2,
                samplerate=44100
            )

        self.current_stream.start()
```

---

## åç»­è¡ŒåŠ¨è®¡åˆ’

### çŸ­æœŸï¼ˆ1-2å¤©ï¼‰
1. ä¿®å¤é‡‡æ ·ç‡å…¼å®¹æ€§é—®é¢˜
2. å®ç°ç³»ç»ŸéŸ³é¢‘é‡‡é›†åŠŸèƒ½ï¼ˆä½¿ç”¨ç«‹ä½“å£°æ··éŸ³ï¼‰
3. ä¼˜åŒ–éŸ³é¢‘æºåˆ‡æ¢é€»è¾‘

### ä¸­æœŸï¼ˆ3-5å¤©ï¼‰
1. æ·»åŠ éŸ³é¢‘å¤„ç†åŠŸèƒ½ï¼ˆé‡é‡‡æ ·ã€æ ¼å¼è½¬æ¢ï¼‰
2. å®ç°VADè¯­éŸ³æ´»åŠ¨æ£€æµ‹
3. æ€§èƒ½ä¼˜åŒ–å’Œç¨³å®šæ€§æµ‹è¯•

### é•¿æœŸï¼ˆ1-2å‘¨ï¼‰
1. é›†æˆè¯­éŸ³è¯†åˆ«å¼•æ“
2. å®ç°å®æ—¶è¯†åˆ«åŠŸèƒ½
3. å®Œæ•´çš„ç«¯åˆ°ç«¯æµ‹è¯•

---

## é™„å½•

### æµ‹è¯•ç¯å¢ƒä¿¡æ¯
- æ“ä½œç³»ç»Ÿ: Windows 10
- Pythonç‰ˆæœ¬: 3.12
- sounddeviceç‰ˆæœ¬: 0.5.5
- numpyç‰ˆæœ¬: 2.4.2
- scipyç‰ˆæœ¬: 1.17.0

### æµ‹è¯•ä»£ç ä½ç½®
- æµ‹è¯•ä»£ç : [tests/test_audio_capture.py](file:///d:\WorkSpace\Project\study_aid3\tests\test_audio_capture.py)
- æµ‹è¯•æŠ¥å‘Š: [audio_capture_test_report.json](file:///d:\WorkSpace\Project\study_aid3\audio_capture_test_report.json)

### å‚è€ƒæ–‡æ¡£
- [01_éŸ³é¢‘é‡‡é›†æŠ€æœ¯åŸç†.md](file:///d:\WorkSpace\Project\study_aid3\docs\01_éŸ³é¢‘é‡‡é›†æŠ€æœ¯åŸç†.md)
- [04_æŠ€æœ¯éªŒè¯æµ‹è¯•ç”¨ä¾‹.md](file:///d:\WorkSpace\Project\study_aid3\docs\04_æŠ€æœ¯éªŒè¯æµ‹è¯•ç”¨ä¾‹.md)
